using System;
using System.Threading;
using System.Windows.Forms;
using System.Reflection;
using System.IO;
using System.Diagnostics;

namespace WeAreDevs
{
    internal static class Program
    {
        [STAThread]
        static void Main(string[] args)
        {
            if (args.Length == 0) Environment.Exit(0);

            Console.Title = $"WeAreDevs - HNT8 - {Settings.Version}";
            Logger.ASCII();

            

            Logger.WriteLine("Thank you for downloading HNT8's WeAreDevs exploit!", Logger.LogType.POSITIVE);
            Logger.WriteLine("If you encounter any issues, please report them at HNT8.net", Logger.LogType.POSITIVE);
            Console.WriteLine();
            Logger.WriteLine("Welcome to the WeAreDevs exploit.\n\n", Logger.LogType.NEGATIVE);

            Discord.Initialize();

            Thread discordStatusThread = new Thread(() =>
            {
                while (true)
                {
                    if (Discord.PresenceEnabled)
                    {
                        if (Execution.isAttached())
                        {
                            Discord.SetStatus("In-Game - Injected");
                        }
                        else
                        {
                            if (Process.GetProcessesByName("RobloxPlayerBeta").Length > 0)
                            {
                                Discord.SetStatus("In-Game - Not Injected");
                            }
                            else
                            {
                                Discord.SetStatus("Not In-Game");
                            }
                        }
                    }
                    else
                    {
                        Discord.ClearPresence();
                    }

                    Thread.Sleep(5000);
                }
            });
            discordStatusThread.Start();

            Thread.Sleep(3000);

            Externals.ToggleConsole();

            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Windows.Main());
        }
    }
}
